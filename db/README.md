# SQLC Generated Code

This directory contains code generated by [sqlc](https://sqlc.dev/), which generates type-safe Go code from SQL queries.

## Structure

- `models.go` - Generated Go structs matching database tables
- `users.sql.go` - Generated functions for user queries
- `todos.sql.go` - Generated functions for todo queries
- `querier.go` - Interface defining all query methods
- `db.go` - Database connection and transaction support
- `queries/` - SQL query files (source of truth)

## Usage

### Generating Code

After modifying SQL queries in `queries/`, regenerate the code:

```bash
task sqlc
# or
sqlc generate
```

### Using in Resolvers

The generated `db.Queries` struct provides type-safe methods:

```go
// Create a user
user, err := r.queries.CreateUser(ctx, db.CreateUserParams{
    ID:        uuid.New().String(),
    Name:      "John Doe",
    Email:     pgtype.Text{String: "john@example.com", Valid: true},
    CreatedAt: timestamp,
    UpdatedAt: timestamp,
})

// Get user by ID
user, err := r.queries.GetUserByID(ctx, userID)

// List all users
users, err := r.queries.ListUsers(ctx)
```

## Available Queries

### Users
- `CreateUser` - Insert a new user
- `GetUserByID` - Get user by ID
- `GetUserByEmail` - Get user by email
- `ListUsers` - List all users
- `UpdateUser` - Update user details
- `DeleteUser` - Delete a user

### Todos
- `CreateTodo` - Insert a new todo
- `GetTodoByID` - Get todo by ID
- `ListTodos` - List all todos
- `ListTodosByUser` - List todos for a specific user
- `UpdateTodo` - Update todo details
- `DeleteTodo` - Delete a todo

## Adding New Queries

1. Add SQL query to `queries/*.sql` with sqlc annotations:
   ```sql
   -- name: QueryName :one
   SELECT * FROM table WHERE id = $1;
   ```

2. Run `sqlc generate` to regenerate code

3. Use the generated function in your resolvers

## Notes

- All generated code is in the `db` package
- sqlc uses `pgtype` for nullable PostgreSQL types
- The `Queries` struct implements the `Querier` interface
- Transactions are supported via `WithTx()` method

